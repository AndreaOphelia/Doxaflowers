---
const { testimonials = [] } = Astro.props;
---

<div
  class="relative w-full flex flex-col items-center text-center py-16 overflow-hidden text-[color:var(--color-primary-content)]"
>
  <h2 class="mb-8">Hvad siger vores kunder?</h2>

  <img
    class="w-12 mx-auto mb-4"
    src="doxafavicondark.svg"
    alt="tegnet blomst"
  />

  <div class="relative w-full h-40 flex items-center justify-center">
    {
      testimonials.map((item, i) => (
        <div
          class="testimonial-slide absolute left-1/2 -translate-x-1/2 opacity-0 transition-opacity duration-700 w-full max-w-xl"
          data-index={i}
        >
          <p class="mb-2">{item.text}</p>
          <p class="opacity-70">{item.author}</p>
        </div>
      ))
    }
  </div>

  <!-- DOTS -->
  <div
    id="indicators"
    class="absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-3 z-20"
  >
    {
      testimonials.map(() => (
        <span
          class="dot w-3 h-3 rounded-full"
          style="background-color: var(--color-primary-content); opacity: 0.3;"
        />
      ))
    }
  </div>
</div>

<script is:client>
  const slides = document.querySelectorAll(".testimonial-slide");
  const dots = document.querySelectorAll(".dot");

  let index = 0;

  function updateSlider() {
    // Slides
    slides.forEach((slide, i) => {
      slide.style.opacity = i === index ? "1" : "0";
    });

    // Dots
    dots.forEach((dot, i) => {
      if (i === index) {
        dot.style.opacity = "1";
      } else {
        dot.style.opacity = "0.3";
      }
    });

    index = (index + 1) % slides.length;
  }

  updateSlider();
  setInterval(updateSlider, 4000);
</script>
