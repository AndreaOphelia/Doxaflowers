---
const { testimonials = [] } = Astro.props;
---

<div
  class="relative w-full flex flex-col items-center text-center py-16 overflow-hidden"
>
  <h2 class="text-2xl font-bold mb-10" style="color: var(--color-primary);">
    Hvad siger vores kunder?
  </h2>

  <div class="relative w-full h-40 flex items-center justify-center">
    {
      testimonials.map((item, i) => (
        <div
          class="testimonial-slide absolute left-1/2 -translate-x-1/2 opacity-0 transition-opacity duration-700 w-full max-w-xl"
          data-index={i}
        >
          <p class="text-lg mb-2">{item.text}</p>
          <p class="text-gray-400">{item.author}</p>
        </div>
      ))
    }
  </div>

  <div
    id="indicators"
    class="absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-3 z-20"
  >
    {
      testimonials.map(() => (
        <span class="dot w-3 h-3 rounded-full bg-white/40" />
      ))
    }
  </div>
</div>

<script is:client>
  const slides = document.querySelectorAll(".testimonial-slide");
  const dots = document.querySelectorAll(".dot");

  let index = 0;

  function updateSlider() {
    slides.forEach((slide, i) => {
      slide.style.opacity = i === index ? "1" : "0";
    });

    dots.forEach((dot, i) => {
      if (i === index) {
        dot.classList.add("bg-white");
        dot.classList.remove("bg-white/40");
      } else {
        dot.classList.remove("bg-white");
        dot.classList.add("bg-white/40");
      }
    });

    index = (index + 1) % slides.length;
  }

  updateSlider();
  setInterval(updateSlider, 4000);
</script>
